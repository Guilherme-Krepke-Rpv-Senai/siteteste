<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login / Cadastro - STYLE CO.</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- HEADER -->
    <header>
        <div class="header-content">
            <h1 class="logo" onclick="goToHome()">STYLE CO.</h1>
            
            <nav class="nav-desktop">
                <button onclick="goToHome()">Home</button>
                <button onclick="goToLoja()">Loja</button>
                <button onclick="window.location.href='./logincad.html'">Cadastrar</button>
                <button onclick="goToSobre()">Sobre</button>
            </nav>

            <div class="header-right">
                <button class="theme-btn" onclick="toggleDarkMode()">üåô</button>
                <button class="cart-btn" onclick="window.location.href='./carrinho.html'">
                    üõí
                    <span class="cart-badge" id="cartBadge" class="hidden">0</span>
                </button>
                <div id="userInfo" class="user-info hidden">
                    <span id="userName"></span>
                    <button onclick="logout()" class="btn-logout">Sair</button>
                </div>
                <button id="btnLogin" class="btn-login" onclick="window.location.href='./logincad.html'">Login</button>
                <button class="mobile-menu-btn" onclick="toggleMobileMenu()">‚ò∞</button>
            </div>
        </div>

        <nav class="nav-mobile" id="mobileMenu">
            <button onclick="goToHome(); toggleMobileMenu()">Home</button>
            <button onclick="goToLoja(); toggleMobileMenu()">Loja</button>
            <button onclick="window.location.href='./logincad.html'; toggleMobileMenu()">Cadastrar</button>
            <button onclick="goToSobre(); toggleMobileMenu()">Sobre</button>
        </nav>
    </header>

    <!-- MAIN -->
    <main>
        <section>
            <h2>Login / Cadastro</h2>
            <div class="login-container">
                <div class="login-tabs">
                    <button class="tab-btn active" onclick="switchTab('tab-login')">Login</button>
                    <button class="tab-btn" onclick="switchTab('tab-cadastro')">Cadastro</button>
                </div>

                <!-- LOGIN -->
                <div id="tab-login" class="tab-content active">
                    <div class="form-container">
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" id="loginEmail" placeholder="seu@email.com">
                        </div>
                        <div class="form-group">
                            <label>Senha</label>
                            <input type="password" id="loginPassword" placeholder="Sua senha">
                        </div>
                        <button class="btn-primary" onclick="handleLogin()">Entrar</button>
                    </div>
                </div>

                <!-- CADASTRO -->
                <div id="tab-cadastro" class="tab-content">
                    <div class="form-container">
                        <div class="form-group">
                            <label>Nome Completo</label>
                            <input type="text" id="cadastroNome" placeholder="Seu nome">
                        </div>
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" id="cadastroEmail" placeholder="seu@email.com">
                        </div>
                        <div class="form-group">
                            <label>Senha</label>
                            <input type="password" id="cadastroPassword" placeholder="M√≠nimo 6 caracteres">
                        </div>
                        <div class="form-group">
                            <label>Confirmar Senha</label>
                            <input type="password" id="cadastroPasswordConfirm" placeholder="Confirme sua senha">
                        </div>
                        <div class="form-group">
                            <label>Tipo de Conta</label>
                            <select id="tipoConta">
                                <option value="cliente">Cliente</option>
                                <option value="vendedor">Vendedor</option>
                            </select>
                        </div>
                        <button class="btn-primary" onclick="handleCadastro()">Criar Conta</button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- FOOTER -->
    <footer>
        <p>&copy; 2024 STYLE CO. - Todos os direitos reservados.</p>
        <p>Desenvolvido com ‚ù§Ô∏è | Moda, qualidade e estilo</p>
    </footer>

    <script>
        let users = [];

        // Carregar usu√°rios do localStorage
        function loadUsers() {
            const savedUsers = JSON.parse(localStorage.getItem('users')) || [];
            users = savedUsers;
            loadCurrentUser();
        }

        // Carregar usu√°rio atual se estiver logado
        function loadCurrentUser() {
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                const user = JSON.parse(savedUser);
                document.getElementById('btnLogin').classList.add('hidden');
                document.getElementById('userInfo').classList.remove('hidden');
                document.getElementById('userName').textContent = `Ol√°, ${user.nome}`;
            }
        }

        // Carregar cart badge
        function updateCartBadge() {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const badge = document.getElementById('cartBadge');
            if (cart.length > 0) {
                badge.innerHTML = cart.length;
                badge.classList.remove('hidden');
            } else {
                badge.classList.add('hidden');
            }
        }

        // Validar for√ßa da senha
        function validatePassword(password) {
            return password.length >= 6;
        }

        // Switch de abas no login
        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // Handle Login
        function handleLogin() {
            const email = document.getElementById('loginEmail').value.trim();
            const password = document.getElementById('loginPassword').value;

            if (!email || !password) {
                alert('‚ùå Preencha todos os campos!');
                return;
            }

            const user = users.find(u => u.email === email && u.password === password);

            if (user) {
                const currentUser = { email: user.email, nome: user.nome, tipo: user.tipo };
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                alert('‚úÖ Login realizado com sucesso! Bem-vindo, ' + user.nome + '!');
                
                document.getElementById('loginEmail').value = '';
                document.getElementById('loginPassword').value = '';
                
                updateUI();
                setTimeout(() => {
                    window.location.href = './index.html';
                }, 1500);
            } else {
                alert('‚ùå Email ou senha incorretos!');
            }
        }

        // Handle Cadastro
        function handleCadastro() {
            const nome = document.getElementById('cadastroNome').value.trim();
            const email = document.getElementById('cadastroEmail').value.trim();
            const password = document.getElementById('cadastroPassword').value;
            const passwordConfirm = document.getElementById('cadastroPasswordConfirm').value;
            const tipo = document.getElementById('tipoConta').value;

            if (!nome || !email || !password || !passwordConfirm) {
                alert('‚ùå Preencha todos os campos!');
                return;
            }

            if (!validatePassword(password)) {
                alert('‚ùå Senha deve ter no m√≠nimo 6 caracteres!');
                return;
            }

            if (password !== passwordConfirm) {
                alert('‚ùå As senhas n√£o conferem!');
                return;
            }

            // Validar email
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                alert('‚ùå Email inv√°lido!');
                return;
            }

            // Verificar se email j√° existe
            if (users.find(u => u.email === email)) {
                alert('‚ùå Este email j√° est√° cadastrado!');
                return;
            }

            // Criar novo usu√°rio
            const newUser = { nome, email, password, tipo, dataCadastro: new Date().toLocaleDateString() };
            users.push(newUser);
            localStorage.setItem('users', JSON.stringify(users));

            alert('‚úÖ Cadastro realizado com sucesso! Fa√ßa login para continuar.');
            
            document.getElementById('cadastroNome').value = '';
            document.getElementById('cadastroEmail').value = '';
            document.getElementById('cadastroPassword').value = '';
            document.getElementById('cadastroPasswordConfirm').value = '';
            
            switchTab('tab-login');
        }

        // Atualizar UI
        function updateUI() {
            const btnLogin = document.getElementById('btnLogin');
            const userInfo = document.getElementById('userInfo');

            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            if (currentUser) {
                btnLogin.classList.add('hidden');
                userInfo.classList.remove('hidden');
                document.getElementById('userName').textContent = `Ol√°, ${currentUser.nome}`;
            } else {
                btnLogin.classList.remove('hidden');
                userInfo.classList.add('hidden');
            }
        }

        // Logout
        function logout() {
            localStorage.removeItem('currentUser');
            updateUI();
            window.location.href = './index.html';
        }

        // DARK MODE
        function toggleDarkMode() {
            document.body.classList.toggle('dark');
            localStorage.setItem('darkMode', document.body.classList.contains('dark'));
        }

        // MOBILE MENU
        function toggleMobileMenu() {
            document.getElementById('mobileMenu').classList.toggle('active');
        }

        // NAVEGA√á√ÉO
        function goToHome() {
            window.location.href = './index.html';
        }

        function goToLoja() {
            window.location.href = './index.html';
        }

        function goToSobre() {
            window.location.href = './index.html';
        }

        // INICIALIZAR
        document.addEventListener('DOMContentLoaded', () => {
            loadUsers();
            updateCartBadge();
            if (localStorage.getItem('darkMode') === 'true') {
                document.body.classList.add('dark');
            }
        });
    </script>
</body>
</html>