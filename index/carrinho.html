<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carrinho de Compras - STYLE CO.</title>
    <link rel="stylesheet" href="../style/style.css">
</head>
<body>
    <!-- HEADER -->
    <header>
        <div class="header-content">
            <h1 class="logo" onclick="goToHome()">STYLE CO.</h1>
            
            <nav class="nav-desktop">
                <button onclick="goToHome()">Home</button>
                <button onclick="goToLoja()">Loja</button>
                <button onclick="goToCadastro()">Cadastrar</button>
                <button onclick="goToSobre()">Sobre</button>
            </nav>

            <div class="header-right">
                <button class="theme-btn" onclick="toggleDarkMode()">üåô</button>
                <button class="cart-btn" onclick="window.location.href='carrinho.html'">
                    üõí
                    <span class="cart-badge" id="cartBadge" class="hidden">0</span>
                </button>
                <button class="mobile-menu-btn" onclick="toggleMobileMenu()">‚ò∞</button>
            </div>
        </div>

        <nav class="nav-mobile" id="mobileMenu">
            <button onclick="goToHome(); toggleMobileMenu()">Home</button>
            <button onclick="goToLoja(); toggleMobileMenu()">Loja</button>
            <button onclick="goToCadastro(); toggleMobileMenu()">Cadastrar</button>
            <button onclick="goToSobre(); toggleMobileMenu()">Sobre</button>
        </nav>
    </header>

    <!-- MAIN -->
    <main>
        <section>
            <h1>üõí Carrinho de Compras</h1>

            <!-- CARRINHO VAZIO -->
            <div id="cartEmpty" class="carrinho-vazio">
                <p>Seu carrinho est√° vazio</p>
                <button class="btn-voltar-loja" onclick="goToLoja()">Continuar Comprando</button>
            </div>

            <!-- CARRINHO COM PRODUTOS -->
            <div id="cartFull" class="hidden">
                <div class="cart-container">
                    <!-- ITEMS -->
                    <div class="cart-items-list" id="cartItems"></div>

                    <!-- RESUMO -->
                    <div class="cart-resumo">
                        <div class="resumo-title">Resumo do Pedido</div>
                        
                        <div class="resumo-item">
                            <span>Subtotal</span>
                            <span>R$ <span id="subtotal">0.00</span></span>
                        </div>

                        <div class="resumo-item">
                            <span>Frete</span>
                            <span>R$ <span id="frete">0.00</span></span>
                        </div>

                        <div class="resumo-item resumo-desconto">
                            <span>Desconto (10%)</span>
                            <span>-R$ <span id="desconto">0.00</span></span>
                        </div>

                        <div class="resumo-total">
                            <div style="display: flex; justify-content: space-between;">
                                <span>TOTAL</span>
                                <span>R$ <span id="total">0.00</span></span>
                            </div>
                        </div>

                        <button class="btn-checkout" onclick="finalizarCompra()">Finalizar Compra</button>
                        <button class="btn-continuar" onclick="goToLoja()">Continuar Comprando</button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- FOOTER -->
    <footer>
        <p>&copy; 2024 STYLE CO. - Todos os direitos reservados.</p>
        <p>Desenvolvido com ‚ù§Ô∏è | Moda, qualidade e estilo</p>
    </footer>

    <script>
        let cart = [];

        // CARREGAR CARRINHO DO LOCALSTORAGE
        function loadCart() {
            const savedCart = localStorage.getItem('cart');
            if (savedCart) {
                cart = JSON.parse(savedCart);
            }
            renderCart();
            updateCartBadge();
        }

        // RENDERIZAR CARRINHO
        function renderCart() {
            if (cart.length === 0) {
                document.getElementById('cartEmpty').classList.remove('hidden');
                document.getElementById('cartFull').classList.add('hidden');
            } else {
                document.getElementById('cartEmpty').classList.add('hidden');
                document.getElementById('cartFull').classList.remove('hidden');

                const cartHtml = cart.map(item => {
                    const itemTotal = item.price * item.quantity;
                    const imageHtml = item.isImage ? 
                        `<img src="${item.image}" alt="${item.name}">` : 
                        item.image;
                    return `
                        <div class="cart-item">
                            <div class="item-image">${imageHtml}</div>
                            <div class="item-details">
                                <h3>${item.name}</h3>
                                <div class="item-price">R$ ${item.price.toFixed(2)}</div>
                                <div class="item-category">${item.category}</div>
                            </div>
                            <div class="item-controls">
                                <div class="quantity-controls">
                                    <button class="qty-btn" onclick="changeQuantity(${item.id}, -1)">‚àí</button>
                                    <div class="qty-display">${item.quantity}</div>
                                    <button class="qty-btn" onclick="changeQuantity(${item.id}, 1)">+</button>
                                </div>
                                <div class="item-total">R$ ${itemTotal.toFixed(2)}</div>
                                <button class="btn-remove" onclick="removeFromCart(${item.id})">Remover</button>
                            </div>
                        </div>
                    `;
                }).join('');

                document.getElementById('cartItems').innerHTML = cartHtml;
                updateResumo();
            }
        }

        // ATUALIZAR RESUMO
        function updateResumo() {
            const subtotal = cart.reduce((sum, item) => sum + item.price * item.quantity, 0);
            const frete = subtotal > 100 ? 0 : 15;
            const desconto = subtotal * 0.10;
            const total = subtotal + frete - desconto;

            document.getElementById('subtotal').textContent = subtotal.toFixed(2);
            document.getElementById('frete').textContent = frete.toFixed(2);
            document.getElementById('desconto').textContent = desconto.toFixed(2);
            document.getElementById('total').textContent = total.toFixed(2);
        }

        // MUDAR QUANTIDADE
        function changeQuantity(id, change) {
            const item = cart.find(p => p.id === id);
            if (item) {
                item.quantity += change;
                if (item.quantity <= 0) {
                    removeFromCart(id);
                } else {
                    saveCart();
                    renderCart();
                }
            }
        }

        // REMOVER DO CARRINHO
        function removeFromCart(id) {
            cart = cart.filter(item => item.id !== id);
            saveCart();
            renderCart();
            updateCartBadge();
        }

        // ATUALIZAR BADGE
        function updateCartBadge() {
            const badge = document.getElementById('cartBadge');
            if (cart.length > 0) {
                badge.textContent = cart.length;
                badge.classList.remove('hidden');
            } else {
                badge.classList.add('hidden');
            }
        }

        // SALVAR CARRINHO
        function saveCart() {
            localStorage.setItem('cart', JSON.stringify(cart));
        }

        // FINALIZAR COMPRA
        function finalizarCompra() {
            alert('Compra finalizada com sucesso!\n\nObrigado por sua compra üéâ');
            cart = [];
            saveCart();
            renderCart();
            updateCartBadge();
        }

        // NAVEGA√á√ÉO
        function goToHome() {
            window.location.href = './index.html';
        }

        function goToLoja() {
            window.location.href = './index.html';
        }

        function goToCadastro() {
            window.location.href = './index.html';
        }

        function goToSobre() {
            window.location.href = './index.html';
        }

        // DARK MODE
        function toggleDarkMode() {
            document.body.classList.toggle('dark');
            localStorage.setItem('darkMode', document.body.classList.contains('dark'));
        }

        // MOBILE MENU
        function toggleMobileMenu() {
            document.getElementById('mobileMenu').classList.toggle('active');
        }

        // INICIALIZAR
        document.addEventListener('DOMContentLoaded', () => {
            loadCart();
            if (localStorage.getItem('darkMode') === 'true') {
                document.body.classList.add('dark');
            }
        });
    </script>
</body>
</html>